<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lab 8: Decision Tree | CSC3206</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@3.x/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css">
    <script id="MathJax-script" async="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <meta name="description" content="">
    
    <link rel="preload" href="/ai-labs/assets/css/0.styles.1f9910a7.css" as="style"><link rel="preload" href="/ai-labs/assets/js/app.ba4b9885.js" as="script"><link rel="preload" href="/ai-labs/assets/js/2.73478500.js" as="script"><link rel="preload" href="/ai-labs/assets/js/15.78b16bcc.js" as="script"><link rel="prefetch" href="/ai-labs/assets/js/10.b2f09101.js"><link rel="prefetch" href="/ai-labs/assets/js/11.1283164e.js"><link rel="prefetch" href="/ai-labs/assets/js/12.4349f2fc.js"><link rel="prefetch" href="/ai-labs/assets/js/13.8d41ee22.js"><link rel="prefetch" href="/ai-labs/assets/js/14.bb1b2952.js"><link rel="prefetch" href="/ai-labs/assets/js/16.8812cc2d.js"><link rel="prefetch" href="/ai-labs/assets/js/17.8c5d4968.js"><link rel="prefetch" href="/ai-labs/assets/js/18.54c1ff1a.js"><link rel="prefetch" href="/ai-labs/assets/js/19.19d67e19.js"><link rel="prefetch" href="/ai-labs/assets/js/20.d387ab4c.js"><link rel="prefetch" href="/ai-labs/assets/js/21.2b642ecd.js"><link rel="prefetch" href="/ai-labs/assets/js/22.c355de6b.js"><link rel="prefetch" href="/ai-labs/assets/js/23.deab0180.js"><link rel="prefetch" href="/ai-labs/assets/js/24.0721fa94.js"><link rel="prefetch" href="/ai-labs/assets/js/25.de4fe1f6.js"><link rel="prefetch" href="/ai-labs/assets/js/26.21926d96.js"><link rel="prefetch" href="/ai-labs/assets/js/27.96885d6d.js"><link rel="prefetch" href="/ai-labs/assets/js/28.2692ecb7.js"><link rel="prefetch" href="/ai-labs/assets/js/29.25fa17f7.js"><link rel="prefetch" href="/ai-labs/assets/js/3.1bc80255.js"><link rel="prefetch" href="/ai-labs/assets/js/30.ab40dbda.js"><link rel="prefetch" href="/ai-labs/assets/js/31.4ff729df.js"><link rel="prefetch" href="/ai-labs/assets/js/32.a107e3fa.js"><link rel="prefetch" href="/ai-labs/assets/js/33.47fee39e.js"><link rel="prefetch" href="/ai-labs/assets/js/34.d9e43d7d.js"><link rel="prefetch" href="/ai-labs/assets/js/35.e1867e84.js"><link rel="prefetch" href="/ai-labs/assets/js/36.8d391f90.js"><link rel="prefetch" href="/ai-labs/assets/js/37.5b47a054.js"><link rel="prefetch" href="/ai-labs/assets/js/38.c3dcb28c.js"><link rel="prefetch" href="/ai-labs/assets/js/39.1fa67cf9.js"><link rel="prefetch" href="/ai-labs/assets/js/4.87946cba.js"><link rel="prefetch" href="/ai-labs/assets/js/40.2a65f7df.js"><link rel="prefetch" href="/ai-labs/assets/js/41.928f4359.js"><link rel="prefetch" href="/ai-labs/assets/js/42.e185bc4b.js"><link rel="prefetch" href="/ai-labs/assets/js/43.4c4edf22.js"><link rel="prefetch" href="/ai-labs/assets/js/44.372fb442.js"><link rel="prefetch" href="/ai-labs/assets/js/45.bdf80815.js"><link rel="prefetch" href="/ai-labs/assets/js/46.00554e62.js"><link rel="prefetch" href="/ai-labs/assets/js/5.ca16e09f.js"><link rel="prefetch" href="/ai-labs/assets/js/6.8b53973d.js"><link rel="prefetch" href="/ai-labs/assets/js/7.b42291b2.js"><link rel="prefetch" href="/ai-labs/assets/js/8.c1ef89a6.js"><link rel="prefetch" href="/ai-labs/assets/js/9.56ad2de4.js">
    <link rel="stylesheet" href="/ai-labs/assets/css/0.styles.1f9910a7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/ai-labs/" class="home-link router-link-active"><!----> <span class="site-name">CSC3206</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/ai-labs/" class="nav-link">
  AI
</a></div><div class="nav-item"><a href="https://ricwtk.github.io/ci-labs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CI
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/ai-labs/" class="nav-link">
  AI
</a></div><div class="nav-item"><a href="https://ricwtk.github.io/ci-labs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CI
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/ai-labs/" aria-current="page" class="sidebar-link">Home</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2021 April</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ai-labs/get-start.html" class="sidebar-link">Getting started</a></li><li><a href="/ai-labs/lab1.html" class="sidebar-link">Lab 1: Basic Python</a></li><li><a href="/ai-labs/lab2.html" class="sidebar-link">Lab 2: Breadth-First Search</a></li><li><a href="/ai-labs/lab3.html" class="sidebar-link">Lab 3: Uniform-Cost Search</a></li><li><a href="/ai-labs/lab4.html" class="sidebar-link">Lab 4: State representation</a></li><li><a href="/ai-labs/lab5.html" class="sidebar-link">Lab 5: pandas</a></li><li><a href="/ai-labs/lab6.html" class="sidebar-link">Lab 6: Linear Regression</a></li><li><a href="/ai-labs/lab7.html" class="sidebar-link">Lab 7: k Nearest Neighbours (KNN)</a></li><li><a href="/ai-labs/lab8.html" class="sidebar-link">Lab 8: Decision Tree</a></li><li><a href="/ai-labs/lab9.html" class="sidebar-link">Lab 9: Clustering</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Archive</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>2020 August</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>2020 March</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>2019 August</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ai-labs/archive/201908/lab1.html" class="sidebar-link">Lab 1: Basic Python</a></li><li><a href="/ai-labs/archive/201908/lab2.html" class="sidebar-link">Lab 2: Breadth-First Search</a></li><li><a href="/ai-labs/archive/201908/lab3.html" class="sidebar-link">Lab 3: Uniform-Cost Search</a></li><li><a href="/ai-labs/archive/201908/lab4.html" class="sidebar-link">Lab 4: State representation</a></li><li><a href="/ai-labs/archive/201908/lab5.html" class="sidebar-link">Lab 5: pandas</a></li><li><a href="/ai-labs/archive/201908/lab6.html" class="sidebar-link">Lab 6: Linear Regression</a></li><li><a href="/ai-labs/archive/201908/lab7.html" class="sidebar-link">Lab 7: k Nearest Neighbours (KNN)</a></li><li><a href="/ai-labs/archive/201908/lab8.html" aria-current="page" class="active sidebar-link">Lab 8: Decision Tree</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ai-labs/archive/201908/lab8.html#objective" class="sidebar-link">Objective</a></li><li class="sidebar-sub-header"><a href="/ai-labs/archive/201908/lab8.html#datasets" class="sidebar-link">Datasets</a></li><li class="sidebar-sub-header"><a href="/ai-labs/archive/201908/lab8.html#decision-tree" class="sidebar-link">Decision tree</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ai-labs/archive/201908/lab8.html#classification" class="sidebar-link">Classification</a></li><li class="sidebar-sub-header"><a href="/ai-labs/archive/201908/lab8.html#regression" class="sidebar-link">Regression</a></li></ul></li></ul></li><li><a href="/ai-labs/archive/201908/lab9.html" class="sidebar-link">Lab 9: Clustering</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="lab-8-decision-tree"><a href="#lab-8-decision-tree" class="header-anchor">#</a> Lab 8: Decision Tree</h1> <h2 id="objective"><a href="#objective" class="header-anchor">#</a> Objective</h2> <ol><li>To perform CART decision tree learning algorithm using the <code>scikit-learn</code> Python library.</li></ol> <h2 id="datasets"><a href="#datasets" class="header-anchor">#</a> Datasets</h2> <p>The same iris and diabetes datasets used in Lab 6a are used here. Load the datasets and split them into 80-20 train-test proportion.</p> <h2 id="decision-tree"><a href="#decision-tree" class="header-anchor">#</a> Decision tree</h2> <p>Decision tree models and algorithms are provided by the <code>scikit-learn</code> as the class <code>sklearn.tree.DecisionTreeClassifier</code> for classification, and <code>sklearn.tree.DecisionTreeRegressor</code> for regression.</p> <h3 id="classification"><a href="#classification" class="header-anchor">#</a> Classification</h3> <ol><li><p>Import the class for decision tree classifier.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>Instantiate an object of <code>DecisionTreeClassifier</code> class with gini impurity as the split criterion.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>dtc <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>criterion<span class="token operator">=</span><span class="token string">'gini'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>Train the classifier with the training data. We will use all the input attributes.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>dtc<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>.predict</code> function is used to predict the species of the testing data.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>predicts <span class="token operator">=</span> dtc<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>Comparing the predicted value and the target value of the test data.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>species<span class="token punctuation">,</span>predicts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">,</span> <span class="token string">'predicted'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>Calculate the accuracy of the predicted value.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>accuracy <span class="token operator">=</span> dtc<span class="token punctuation">.</span>score<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>iris<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>species<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Accuracy: </span><span class="token interpolation"><span class="token punctuation">{</span>accuracy<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>Decision tree visualisation</p> <ol><li><p>Import the <code>matplotlib.pyplot</code> library and the function to visualise the tree.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> plot_tree
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>Visualise the decision tree model.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
tree <span class="token operator">=</span> plot_tree<span class="token punctuation">(</span>dtc<span class="token punctuation">,</span> feature_names<span class="token operator">=</span>iris<span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>columns<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                 class_names<span class="token operator">=</span>iris<span class="token punctuation">[</span><span class="token string">'targetNames'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> filled<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> rounded<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol></li></ol> <p>The maximum depth of a decision tree can be defined by adding the <code>max_depth=...</code> argument to the <code>DecisionTreeClassifier(...)</code> object instantiation. To allow unlimited maximum depth, pass <code>max_depth=None</code>.</p> <p><strong>Task</strong>: Create a loop to compare the accuracy of the prediction with different maximum depths. Use 1, 2, 3, 5, 7, and 20 as the maximum depths. In every iteration, you should calculate both the accuracy on the training data and the accuracy on the testing data. The comparison should be shown in a graph with <code>max_depth</code> as the horizontal axis and accuracy as the vertical axis. Two lines should be displayed on the graph with one line for training accuracy and the other testing accuracy.</p> <h4 id="visualisation-of-decision-surface"><a href="#visualisation-of-decision-surface" class="header-anchor">#</a> Visualisation of decision surface</h4> <p>This section explains the method to visualise a decision tree on a graph. To do so we will focus on using two input attributes, sepal length and sepal width, i.e. the first two columns.</p> <ol><li><p>Instantiate the classifier without defining the maximum depth and train the model.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>dtc <span class="token operator">=</span> DecisiontTreeClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>
input_cols <span class="token operator">=</span> iris<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
dtc<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">]</span><span class="token punctuation">,</span> iris<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>species<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>Plot the decision tree.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plot_tree<span class="token punctuation">(</span>dtc<span class="token punctuation">,</span> feature_names<span class="token operator">=</span>input_cols<span class="token punctuation">,</span> 
          class_names<span class="token operator">=</span>iris<span class="token punctuation">[</span><span class="token string">'targetNames'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> filled<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> rounded<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'classificationDecisionTreeWithNoMaxDepth.png'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>Prepare the colormaps.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> cm
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>colors <span class="token keyword">import</span> ListedColormap
colormap <span class="token operator">=</span> cm<span class="token punctuation">.</span>get_cmap<span class="token punctuation">(</span><span class="token string">'tab20'</span><span class="token punctuation">)</span>
cm_dark <span class="token operator">=</span> ListedColormap<span class="token punctuation">(</span>colormap<span class="token punctuation">.</span>colors<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cm_light <span class="token operator">=</span> ListedColormap<span class="token punctuation">(</span>colormap<span class="token punctuation">.</span>colors<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>Calculating the decision surface.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
x_min <span class="token operator">=</span> iris<span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
x_max <span class="token operator">=</span> iris<span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
x_range <span class="token operator">=</span> x_max <span class="token operator">-</span> x_min
x_min <span class="token operator">=</span> x_min <span class="token operator">-</span> <span class="token number">0.1</span> <span class="token operator">*</span> x_range
x_max <span class="token operator">=</span> x_max <span class="token operator">+</span> <span class="token number">0.1</span> <span class="token operator">*</span> x_range
y_min <span class="token operator">=</span> iris<span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
y_max <span class="token operator">=</span> iris<span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
y_range <span class="token operator">=</span> y_max <span class="token operator">-</span> y_min
y_min <span class="token operator">=</span> y_min <span class="token operator">-</span> <span class="token number">0.1</span> <span class="token operator">*</span> y_range
y_max <span class="token operator">=</span> y_max <span class="token operator">+</span> <span class="token number">0.1</span> <span class="token operator">*</span> y_range
xx<span class="token punctuation">,</span> yy <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> <span class="token number">.01</span><span class="token operator">*</span>x_range<span class="token punctuation">)</span><span class="token punctuation">,</span> 
                    np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">,</span> <span class="token number">.01</span><span class="token operator">*</span>y_range<span class="token punctuation">)</span><span class="token punctuation">)</span>
z <span class="token operator">=</span> dtc<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>xx<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
z <span class="token operator">=</span> z<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>xx<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li> <li><p>Plot the decision surface.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>pcolormesh<span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> z<span class="token punctuation">,</span> cmap<span class="token operator">=</span>cm_light<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>Plot the training and testing data.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   
            iris<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            c<span class="token operator">=</span>iris<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>species<span class="token punctuation">,</span> cmap<span class="token operator">=</span>cm_dark<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>
            label<span class="token operator">=</span><span class="token string">'Training data'</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            iris<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            c<span class="token operator">=</span>iris<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>species<span class="token punctuation">,</span> cmap<span class="token operator">=</span>cm_dark<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>
            label<span class="token operator">=</span><span class="token string">'Testing data'</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
            marker<span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">)</span>
train_acc <span class="token operator">=</span> dtc<span class="token punctuation">.</span>score<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">]</span><span class="token punctuation">,</span> 
                      iris<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>species<span class="token punctuation">)</span>
test_acc <span class="token operator">=</span> dtc<span class="token punctuation">.</span>score<span class="token punctuation">(</span>iris<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">]</span><span class="token punctuation">,</span> 
                    iris<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>species<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'training: </span><span class="token interpolation"><span class="token punctuation">{</span>train_acc<span class="token punctuation">:</span><span class="token format-spec">.3f</span><span class="token punctuation">}</span></span><span class="token string">, testing: </span><span class="token interpolation"><span class="token punctuation">{</span>test_acc<span class="token punctuation">:</span><span class="token format-spec">.3f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span>input_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span>input_cols<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li></ol> <p>You may not be able to see anything on one of the graph of the decision tree because the figure size is set to be larger than the screen size. However, the tree is saved to a png file in the same folder as your code.</p> <h4 id="overfitting"><a href="#overfitting" class="header-anchor">#</a> Overfitting</h4> <p>Now, instantiate a decision tree classifier of <code>max_depth=3</code> and train it with the two input attributes used in the previous section, sepal length and sepal width.</p> <p>Plot the decision surface for this classifier after the training. Compare the decision surface, training accuracy, and testing accuracy between this model and the model in the previous section.</p> <p>The previous model shows a situation of overfitting. Though the training accuracy of this model is lower than that of the previous one, the testing accuracy is higher than the previous one. That shows a higher level of generalisation.</p> <h3 id="regression"><a href="#regression" class="header-anchor">#</a> Regression</h3> <ol><li><p>Import the class for decision tree regressor.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeRegressor
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>Instantiate an object of <code>DecisionTreeRegressor</code> class.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>dtr <span class="token operator">=</span> DecisionTreeRegressor<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>Train the classifier with the training data. We will use all the input attributes.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>dtr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>diabetes<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> diabetes<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>.predict</code> function is used to predict the disease progression of the testing data.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>predicts <span class="token operator">=</span> dtr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>diabetes<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>Comparing the predicted value and the target value of the test data.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>diabetes<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>diseaseProgression<span class="token punctuation">,</span>predicts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">,</span> <span class="token string">'predicted'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>Calculate the accuracy of the predicted value.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>accuracy <span class="token operator">=</span> dtr<span class="token punctuation">.</span>score<span class="token punctuation">(</span>diabetes<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    diabetes<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>diseaseProgression<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Accuracy: </span><span class="token interpolation"><span class="token punctuation">{</span>accuracy<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>Decision tree visualisation</p> <ol><li><p>Import the <code>matplotlib.pyplot</code> library and the function to visualise the tree.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> plot_tree
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>Visualise the decision tree model.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
tree <span class="token operator">=</span> plot_tree<span class="token punctuation">(</span>dtr<span class="token punctuation">,</span> feature_names<span class="token operator">=</span>diabetes<span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>columns<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                filled<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> rounded<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol></li></ol> <p>The maximum depth of a decision tree can be defined by adding the <code>max_depth=...</code> argument to the <code>DecisionTreeRegressor(...)</code> object instantiation. To allow unlimited maximum depth, pass <code>max_depth=None</code>.</p> <p><strong>Task</strong>: Create a loop to compare the accuracy of the prediction with different maximum depths. Use 1, 2, 3, 5, 7, and 20 as the maximum depths. In every iteration, you should calculate both the accuracy on the training data and the accuracy on the testing data. The comparison should be shown in a graph with <code>max_depth</code> as the horizontal axis and accuracy as the vertical axis. Two lines should be displayed on the graph with one line for training accuracy and the other testing accuracy.</p> <h4 id="visualisation-of-decision-surface-2"><a href="#visualisation-of-decision-surface-2" class="header-anchor">#</a> Visualisation of decision surface</h4> <p>This section explains the method to visualise a decision tree on a graph. To do so we will focus on using two input attributes, <code>age</code> and <code>bmi</code>.</p> <ol><li><p>Instantiate the classifier without defining the maximum depth and train the model.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>dtr <span class="token operator">=</span> DecisiontTreeRegressor<span class="token punctuation">(</span><span class="token punctuation">)</span>
input_cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'bmi'</span><span class="token punctuation">]</span>
dtr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>diabetes<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">]</span><span class="token punctuation">,</span> 
        diabetes<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>diseaseProgression<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>Plot the decision tree.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plot_tree<span class="token punctuation">(</span>dtr<span class="token punctuation">,</span> feature_names<span class="token operator">=</span>input_cols<span class="token punctuation">,</span> filled<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> rounded<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'regressionDecisionTreeWithNoMaxDepth.png'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>Prepare the colormaps.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> cm
dia_cm <span class="token operator">=</span> cm<span class="token punctuation">.</span>get_cmap<span class="token punctuation">(</span><span class="token string">'Reds'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>Create the decision surface.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
x_min <span class="token operator">=</span> diabetes<span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
x_max <span class="token operator">=</span> diabetes<span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
x_range <span class="token operator">=</span> x_max <span class="token operator">-</span> x_min
x_min <span class="token operator">=</span> x_min <span class="token operator">-</span> <span class="token number">0.1</span> <span class="token operator">*</span> x_range
x_max <span class="token operator">=</span> x_max <span class="token operator">+</span> <span class="token number">0.1</span> <span class="token operator">*</span> x_range
y_min <span class="token operator">=</span> diabetes<span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
y_max <span class="token operator">=</span> diabetes<span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
y_range <span class="token operator">=</span> y_max <span class="token operator">-</span> y_min
y_min <span class="token operator">=</span> y_min <span class="token operator">-</span> <span class="token number">0.1</span> <span class="token operator">*</span> y_range
y_max <span class="token operator">=</span> y_max <span class="token operator">+</span> <span class="token number">0.1</span> <span class="token operator">*</span> y_range
xx<span class="token punctuation">,</span> yy <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> <span class="token number">.01</span><span class="token operator">*</span>x_range<span class="token punctuation">)</span><span class="token punctuation">,</span> 
                    np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">,</span> <span class="token number">.01</span><span class="token operator">*</span>y_range<span class="token punctuation">)</span><span class="token punctuation">)</span>
z <span class="token operator">=</span> dtr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>xx<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
z <span class="token operator">=</span> z<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>xx<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li> <li><p>Plot the decision surface</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>pcolormesh<span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> z<span class="token punctuation">,</span> cmap<span class="token operator">=</span>dia_cm<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>Plot the training and testing data.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>diabetes<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          
            diabetes<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            c<span class="token operator">=</span>diabetes<span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>diseaseProgression<span class="token punctuation">,</span> 
            label<span class="token operator">=</span><span class="token string">'Training data'</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>dia_cm<span class="token punctuation">,</span> 
            edgecolor<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>diabetes<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   
            diabetes<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'attributes'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>input_cols<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            c<span class="token operator">=</span>diabetes<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>diseaseProgression<span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">,</span> 
            label<span class="token operator">=</span><span class="token string">'Testing data'</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>dia_cm<span class="token punctuation">,</span> 
            edgecolor<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span>input_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span>input_cols<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li></ol> <h4 id="overfitting-2"><a href="#overfitting-2" class="header-anchor">#</a> Overfitting</h4> <p>Now, instantiate a decision tree regressor of <code>max_depth=3</code> and train it with the two input attributes used in the previous section, <code>age</code> and <code>bmi</code>.</p> <p>Plot the decision surface for this regressor after the training. Compare the decision surface, training accuracy, and testing accuracy between this model and the model in the previous section.</p> <p>The previous model shows a situation of overfitting. Though the training accuracy of this model is lower than that of the previous one, the testing accuracy is higher than the previous one. That shows a higher level of generalisation.</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/25/2020, 3:59:34 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/ai-labs/archive/201908/lab7.html" class="prev">
        Lab 7: k Nearest Neighbours (KNN)
      </a></span> <span class="next"><a href="/ai-labs/archive/201908/lab9.html">
        Lab 9: Clustering
      </a>
      
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/ai-labs/assets/js/app.ba4b9885.js" defer></script><script src="/ai-labs/assets/js/2.73478500.js" defer></script><script src="/ai-labs/assets/js/15.78b16bcc.js" defer></script>
  </body>
</html>
